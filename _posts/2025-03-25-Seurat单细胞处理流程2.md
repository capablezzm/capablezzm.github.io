---
layout: post
title: "Seuratå•ç»†èƒå¤„ç†æµç¨‹ä¹‹äºŒï¼šæ•°æ®è´¨æ§"
date: 2025-03-25
categories: Seurat
tags: [å¿ƒå¾—, å­¦ä¹ , Seurat,å•ç»†èƒæµç¨‹]
toc:  true
---

# 1.ç®€ä»‹
å•ç»†èƒRNAæµ‹åºï¼ˆscRNA-seqï¼‰æ•°æ®è´¨é‡æ§åˆ¶ï¼ˆQuality Control, QCï¼‰æ˜¯åˆ†ææµç¨‹ä¸­çš„å…³é”®æ­¥éª¤ã€‚ç”±äºå•ç»†èƒæµ‹åºæŠ€æœ¯å­˜åœ¨ä¸€å®šçš„å™ªéŸ³å’ŒæŠ€æœ¯è¯¯å·®ï¼Œè´¨æ§çš„ç›®çš„æ˜¯å»é™¤ä½è´¨é‡ç»†èƒå’Œå¼‚å¸¸æ•°æ®ï¼Œæé«˜åç»­åˆ†æçš„å¯é æ€§å’Œç”Ÿç‰©å­¦æ„ä¹‰ã€‚
# 2.æ•°æ®è¯»å…¥
ä»¥pbmcç¤ºä¾‹æ•°æ®ä¸ºä¾‹ï¼š
```R
rm(list = ls())
setwd("/mnt/DEV_8T/zhaozm/seuratå…¨æµç¨‹/æ•°æ®è´¨æ§")

##ç¦æ­¢è½¬åŒ–ä¸ºå› å­
options(stringsAsFactors = FALSE)
```


```R
library(Seurat)
library(dplyr)
library(readr)
library(Matrix)
library(ggplot2)
library(patchwork)
library(ggplot2)
```

    è½½å…¥éœ€è¦çš„ç¨‹åºåŒ…ï¼šSeuratObject
    
    è½½å…¥éœ€è¦çš„ç¨‹åºåŒ…ï¼šsp
    
    
    è½½å…¥ç¨‹åºåŒ…ï¼šâ€˜SeuratObjectâ€™
    
    
    The following objects are masked from â€˜package:baseâ€™:
    
        intersect, t
    
    
    
    è½½å…¥ç¨‹åºåŒ…ï¼šâ€˜dplyrâ€™
    
    
    The following objects are masked from â€˜package:statsâ€™:
    
        filter, lag
    
    
    The following objects are masked from â€˜package:baseâ€™:
    
        intersect, setdiff, setequal, union
    
    



```R
#è¯»å…¥æ•°æ®
pbmc.data <- Read10X(data.dir = "filtered_gene_bc_matrices/hg19/")
```


```R
## åˆ›å»ºseuratå¯¹è±¡
pbmc <- CreateSeuratObject(counts = pbmc.data, project = "pbmc3k", min.cells = 3, min.features = 200)
```

    Warning message:
    â€œFeature names cannot have underscores ('_'), replacing with dashes ('-')â€



```R
#åˆæ­¥æŸ¥çœ‹Seuratå¯¹è±¡
pbmc
```


    An object of class Seurat 
    13714 features across 2700 samples within 1 assay 
    Active assay: RNA (13714 features, 0 variable features)
     1 layer present: counts

# 3.è´¨æ§æ•°æ®åŠå¯è§†åŒ–




```R
## è®¡ç®—çº¿ç²’ä½“æ¯”ä¾‹
pbmc[["percent.mt"]] <- PercentageFeatureSet(pbmc, pattern = "^MT-") 
#äººæºçš„æ•°æ®ä¸ºMTï¼Œé¼ æºçš„éœ€è¦æ¢æˆmt
head(pbmc@meta.data,5)
```


<table class="dataframe">
<caption>A data.frame: 5 Ã— 4</caption>
<thead>
	<tr><th></th><th scope=col>orig.ident</th><th scope=col>nCount_RNA</th><th scope=col>nFeature_RNA</th><th scope=col>percent.mt</th></tr>
	<tr><th></th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>AAACATACAACCAC-1</th><td>pbmc3k</td><td>2419</td><td> 779</td><td>3.0177759</td></tr>
	<tr><th scope=row>AAACATTGAGCTAC-1</th><td>pbmc3k</td><td>4903</td><td>1352</td><td>3.7935958</td></tr>
	<tr><th scope=row>AAACATTGATCAGC-1</th><td>pbmc3k</td><td>3147</td><td>1129</td><td>0.8897363</td></tr>
	<tr><th scope=row>AAACCGTGCTTCCG-1</th><td>pbmc3k</td><td>2639</td><td> 960</td><td>1.7430845</td></tr>
	<tr><th scope=row>AAACCGTGTATGCG-1</th><td>pbmc3k</td><td> 980</td><td> 521</td><td>1.2244898</td></tr>
</tbody>
</table>




```R
VlnPlot(pbmc, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3) 
```

    Warning message:
    â€œDefault search for "data" layer in "RNA" assay yielded no results; utilizing "counts" layer instead.â€



    
![è´¨æ§è¿‡æ»¤_7_1.png](https://cdn.jsdelivr.net/gh/capablezzm/capablezzm.github.io@main/images/2025/3/1742886854850.png)
    



```R

plot1 <- FeatureScatter(pbmc, feature1 = "nCount_RNA", feature2 = "percent.mt")
plot2 <- FeatureScatter(pbmc, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
if(!require(patchwork))install.packages("patchwork")
CombinePlots(plots = list(plot1, plot2)) 
```

    Warning message in CombinePlots(plots = list(plot1, plot2)):
    â€œCombinePlots is being deprecated. Plots should now be combined using the patchwork system.â€



    
![è´¨æ§è¿‡æ»¤_8_1.png](https://cdn.jsdelivr.net/gh/capablezzm/capablezzm.github.io@main/images/2025/3/1742886860153.png)
    



```R
## è¿‡æ»¤
pbmc <- subset(pbmc, subset = nFeature_RNA > 200 & nFeature_RNA < 2500 & percent.mt < 5)   
ncol(as.data.frame(GetAssayData(pbmc, slot = "counts")))
## [1] 2638
```

    Warning message:
    â€œ[1m[22mThe `slot` argument of `GetAssayData()` is deprecated as of SeuratObject 5.0.0.
    [36mâ„¹[39m Please use the `layer` argument instead.â€



2638



```R
## è¿‡æ»¤ä¹‹åçš„å›¾ç‰‡
plot1 <- FeatureScatter(pbmc, feature1 = "nCount_RNA", feature2 = "percent.mt")
plot2 <- FeatureScatter(pbmc, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
if(!require(patchwork))install.packages("patchwork")
#CombinePlotsè¿™æ­¥éœ€è¦ä½ çš„ç»˜å›¾çª—å£è¶³å¤Ÿå¤§
CombinePlots(plots = list(plot1, plot2)) 

```

    Warning message in CombinePlots(plots = list(plot1, plot2)):
    â€œCombinePlots is being deprecated. Plots should now be combined using the patchwork system.â€



    
![è´¨æ§è¿‡æ»¤_10_1.png](https://cdn.jsdelivr.net/gh/capablezzm/capablezzm.github.io@main/images/2025/3/1742886870193.png)
    



```R
VlnPlot(pbmc, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3) 
```

    Warning message:
    â€œDefault search for "data" layer in "RNA" assay yielded no results; utilizing "counts" layer instead.â€



    
![è´¨æ§è¿‡æ»¤_11_1.png](https://cdn.jsdelivr.net/gh/capablezzm/capablezzm.github.io@main/images/2025/3/1742886873448.png)
    

